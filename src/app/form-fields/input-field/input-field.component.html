<ng-container #inputFieldContainer>
    <div *ngIf="!makingChanges; else inputFieldSettings" class="field-container">
        <div class="form-field-and-label">
            <span> {{ componentPosition + 1 }} . </span>
            <mat-form-field color="primary" [floatLabel]="'never'">
                <mat-label [ngClass]="{'required': isRequired}">{{ title }}</mat-label>
                <input matInput readonly="true" type="text">
            </mat-form-field>
        </div>
        <div class="field-action-btn-container">
            <app-form-field-actions (componentAction)="triggerComponentAction($event.action, $event.direction)"></app-form-field-actions>
        </div>
    </div>

    <ng-template #inputFieldSettings>
        <div class="field-settings-container">
            <form [formGroup]="fieldSettingsForm" style="width: 100%;">
                <div>
                    <mat-form-field color="primary">
                        <mat-label>Title</mat-label>
                        <input formControlName="title" matInput type="text">
                    </mat-form-field>
                </div>
                <div>
                    <mat-form-field color="primary">
                        <mat-label>Position</mat-label>
                        <input formControlName="position" matInput type="number">
                    </mat-form-field>
                </div>
                <div>
                    <mat-label style="margin-right: 5px;">Required</mat-label>
                    <mat-checkbox [checked]="isRequired" color="primary" formControlName="isRequired"></mat-checkbox>
                </div>
                <div>
                    <mat-label style="margin-right: 5px;">Always show this field</mat-label>
                    <mat-checkbox (change)="showFieldVisibilitySettings($event.checked)" [checked]="fieldIsVisible" color="primary" formControlName="fieldVisible"></mat-checkbox>
                    <ng-container *ngIf="!fieldIsVisible">
                        <h4>Visible if</h4>
                        <div id="field-visibility-settings-form">
                            <mat-form-field class="form-field-select">
                                <mat-label>Select question</mat-label>
                                <mat-select (selectionChange)="getSelectedComponentToTriggerFieldVisibility($event.value)" class="custom-dropdown" [(value)]="currentlySelectedChoice">
                                    <mat-option *ngFor="let field of availableFormFieldsWithChoices" [value]="field">
                                        {{ field.instance.title }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <div>
                                <span *ngIf="currentlySelectedOption">is equal to the ff:</span>
                                <div *ngFor="let option of selectedFormFieldForFieldVisibility?.instance?.currentFieldOptionsValue">
                                    <mat-checkbox color="primary">
                                        {{ option }}
                                    </mat-checkbox>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="action-btn-container">
                    <button (click)="hideFieldSettings()" mat-raised-button type="button">Cancel</button>
                    <button (click)="saveFieldSettings()" color="primary" mat-raised-button type="button">Okay</button>
                </div>
            </form>
        </div>
    </ng-template>
</ng-container>